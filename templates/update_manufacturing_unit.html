{% extends 'customer_navbar.html' %}
{% load static %}
{% block title %}Update Manufacturing Unit{% endblock title %}
{% block content %}
<div class="container">
    <div class="row">
        <form action="" method="post">
            {% csrf_token %}
            {% comment %} Manufacturing Unit Detail {% endcomment %}
            <div class="col-6">
                <h3 class="my-3 fw-bold">View Manufacturer Detail<span class="me-2 float-end" type="button" data-bs-toggle="modal"
                    data-bs-target="#editmodal"><i class="fas fa-pencil-alt"></i></span></h3>

                    <div class="container">
                        {% if messages %}
                        {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                          <strong>{{ message }}</strong>
                          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>  
                        {% endfor %}
                        {% endif %}
                    </div>

                    <div class="heading-button">
          

                        <div class="modal fade" id="editmodal" >
                            <div class="modal-dialog modal-dialog-centered modal-lg">
                                <div class="modal-content">
            
                                    <!-- Modal Header -->
            
                                    <div style=" background-color:#ed8b00;" class="sub-heading shadow mb-4 rounded text-center text-dark fw-bold encrypted_header">
                                        Edit Customer Detail
                                    </div>
                                    
                                    <!-- Modal body -->
                                    <div class="modal-body">
                                        <p style="color:red;" id="error_message"></p>
                                        <form method="POST">
                                            {% csrf_token %} 
                                
                                            <div class="row">
                                               <div class="col-12">
                                                <div class="mb-3">
                                                    <label class="form-label">Customer* :</label>
                                                    {% comment %} <input type="text" class="form-control" name="manufacturer_unit_name" autofocus> {% endcomment %}
                                                      <select class="form-control" onchange="" name="unit_type" id="" autofocus  readonly>
                                                        <option value="{{update_manufacturing_unit.unit_type}}" selected>{{update_manufacturing_unit.unit_type}}</option>
                                                        {% comment %} <option value="">Select Manufacturer / Distributor Unit Type</option>
                                                        <option value="Distributer">Distributer</option>
                                                        <option value="Manufacturer">Manufacturer</option> {% endcomment %}
                                                        
                                                        
                                                    </select>  
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Primary Contact :</label>
                                                    <div class="row">
                                                        <div class="col-4">
                                                            <select class="form-control" name="salutation">
                                                                <option selected>{{update_manufacturing_unit.salutation}}</option>
                                                                <option>Salutation</option>
                                                                <option>Mr</option>
                                                                <option>Mrs</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-4">
                                                            <input type="text" class="form-control" name="first_name" placeholder="First Name" value={{update_manufacturing_unit.first_name|capfirst}}>
                                                        </div>
                                                        <div class="col-4">
                                                            <input type="text" class="form-control" name="last_name" placeholder="Last Name" value={{update_manufacturing_unit.last_name|capfirst}}>
                                                        </div>
                                                    </div>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Customer :</label>
                                                    {% comment %} <select class="form-control" name="manufacturer">
                                                        <option value="{{update_manufacturing_unit.id}}" selected>{{update_manufacturing_unit.manufacturer}}</option>
                                                        <option>Select Manufacturer</option>
                                                        {% for manufacturers in list_manufacturer %}
                                                        <option value="{{manufacturers.id}}">{{manufacturers.user}}</option>
                                                        {% endfor %}
                                                    </select> {% endcomment %}
                                                    <input type="text" class="form-control" name="manufacturer" value={{update_manufacturing_unit.manufacturers|capfirst}}>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Contact Person :</label>
                                                    <input type="text" class="form-control" name="contact_person" value={{update_manufacturing_unit.contact_person|capfirst}}>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Company Name :</label>
                                                    <input type="text" class="form-control" name="company_name" value="{{update_manufacturing_unit.company_name|capfirst}}">
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Email :</label>
                                                    <input type="email" class="form-control" name="email" value={{update_manufacturing_unit.email}}>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Phone :</label>
                                                    <input type="number" class="form-control" name="phone_number" value={{update_manufacturing_unit.phone_number}} maxlength="10" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Website :</label>
                                                    <input type="text" class="form-control" name="website" value="{{update_manufacturing_unit.website}}">
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Pan Number :</label>
                                                    <input type="text" class="form-control" name="pan_number" value={{update_manufacturing_unit.pan_number}}>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Currency :</label>
                                                    <input type="text" class="form-control" name="currency" value={{update_manufacturing_unit.currency|upper}}>
                                                </div>
                                
                                                <div class="mb-3">
                                                    <label class="form-label">Payment Term :</label>
                                                    <input type="text" class="form-control" name="m_payment_term" value={{update_manufacturing_unit.m_payment_term}}>
                                                </div>
                                               </div>
                                            </div>

                                            <div class="row">
                                                {% comment %} Billing Address {% endcomment %}
                                                <div class="col-12">
                                                    <h4 class="my-3 fw-bold text-muted">Manufacturing Unit Address</h4>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Attention :</label>
                                                        <input type="text" class="form-control" name="attention" value="{{update_manufacturing_unit_address.manufacturing_unit_attention|capfirst}}">
                                                    </div>
                                        
                                                    {% comment %} <div class="mb-3">
                                                        <label class="form-label">Country / Region :</label>
                                                        <input type="text" class="form-control" name="country" value="{{update_manufacturing_unit_address.manufacturing_unit_country|capfirst}}">
                                                    </div> {% endcomment %}
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Address :</label>
                                                        <input type="text" class="form-control" name="address" value="{{update_manufacturing_unit_address.manufacturing_unit_address|capfirst}}">
                                                    </div>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Country* :</label>
                                                        {% comment %} <input type="text" class="form-control" name="manufacturing_unit_country" required> {% endcomment %}
                                                        <select class="country form-select" name="country" required>
                                                            <option value="{{update_manufacturing_unit_address.manufacturing_unit_country|capfirst}}">{{update_manufacturing_unit_address.manufacturing_unit_country|capfirst}}</option>
                                                            <option value="">Select Country</option>
                                                        </select>
                                                    </div>
                                        
                                                    
                                        
                                                   
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">State* :</label>
                                                        {% comment %} <input type="text" class="form-control" name="state" placeholder="State" required> {% endcomment %}
                                                        <select class="state form-select" name="state" required>
                                                            <option value="{{update_manufacturing_unit_address.manufacturing_unit_state|capfirst}}">{{update_manufacturing_unit_address.manufacturing_unit_state|capfirst}}</option>
                                                            <option value="">Select State</option>
                                                           
                                                            </select>
                                                    </div>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">City* :</label>
                                                        <select class="region form-select" name="city" required>
                                                            <option value="{{update_manufacturing_unit_address.manufacturing_unit_city}}">{{update_manufacturing_unit_address.manufacturing_unit_city}}</option>
                                                          <option value="">Select City</option>
                                                    
                                                      </select>
                                                    </div>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Zip Code :</label>
                                                        <input type="number" class="form-control" name="zip_code" value="{{update_manufacturing_unit_address.manufacturing_unit_zip_code}}">
                                                    </div>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Phone Number :</label>
                                                        <input type="number" class="form-control" name="manufacturing_unit_phone_number" value="{{update_manufacturing_unit_address.manufacturing_unit_phone_number}}" maxlength="10" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">
                                                    </div>
                                        
                                                    <div class="mb-3">
                                                        <label class="form-label">Fax :</label>
                                                        <input type="text" class="form-control" name="fax" value="{{update_manufacturing_unit_address.manufacturing_unit_fax}}">
                                                    </div>
                                        
                                                </div>
                                                
                                            </div>
                                            
                                            <input type="submit" id="btn-submit" name="btn-category" class="btn fw-bold "style=" background-color:#ed8b00;" value="Update Unit Detail" required>
                                        </form>
                                            
                                    </div>
            
                                </div>
                            </div>
                        </div>
                    </div>
                <div class="mb-3">
                    <label class="form-label">Unit Type* :</label>
                    {% comment %} <input type="text" class="form-control" name="manufacturer_unit_name" autofocus> {% endcomment %}
                      <select class="form-control" onchange="" name="unit_type" id="" autofocus  readonly>
                        <option value="{{update_manufacturing_unit.unit_type}}" selected>{{update_manufacturing_unit.unit_type}}</option>
                        {% comment %} <option value="">Select Manufacturer / Distributor Unit Type</option>
                        <option value="Distributer">Distributer</option>
                        <option value="Manufacturer">Manufacturer</option> {% endcomment %}
                        
                        
                    </select>  
                </div>

                <div class="mb-3">
                    <label class="form-label">Primary Contact :</label>
                    <div class="row">
                        <div class="col-4">
                            <select class="form-control" readonly>
                                <option selected>{{update_manufacturing_unit.salutation}}</option>
                                <option>Salutation</option>
                                <option>Mr</option>
                                <option>Mrs</option>
                            </select>
                        </div>
                        <div class="col-4">
                            <input type="text" class="form-control" placeholder="First Name" value={{update_manufacturing_unit.first_name|capfirst}} readonly>
                        </div>
                        <div class="col-4">
                            <input type="text" class="form-control" placeholder="Last Name" value={{update_manufacturing_unit.last_name|capfirst}} readonly>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Manufacturer Name :</label>
                    {% comment %} <select class="form-control" name="manufacturer">
                        <option value="{{update_manufacturing_unit.id}}" selected>{{update_manufacturing_unit.manufacturer}}</option>
                        <option>Select Manufacturer</option>
                        {% for manufacturers in list_manufacturer %}
                        <option value="{{manufacturers.id}}">{{manufacturers.user}}</option>
                        {% endfor %}
                    </select> {% endcomment %}
                    <input type="text" class="form-control" readonly value={{update_manufacturing_unit.manufacturers|capfirst}} >
                </div>

                <div class="mb-3">
                    <label class="form-label">Contact Person :</label>
                    <input type="text" class="form-control" value={{update_manufacturing_unit.contact_person|capfirst}} readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Company Name :</label>
                    <input type="text" class="form-control" value="{{update_manufacturing_unit.company_name|capfirst}}" readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Email :</label>
                    <input type="email" class="form-control" value={{update_manufacturing_unit.email}} readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Phone :</label>
                    <input type="number" class="form-control" value={{update_manufacturing_unit.phone_number}} maxlength="10" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Website :</label>
                    <input type="text" class="form-control" value="{{update_manufacturing_unit.website}}" readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Pan Number :</label>
                    <input type="text" class="form-control" readonly value={{update_manufacturing_unit.pan_number}} >
                </div>

                <div class="mb-3">
                    <label class="form-label">Currency :</label>
                    <input type="text" class="form-control" value={{update_manufacturing_unit.currency|upper}} readonly>
                </div>

                <div class="mb-3">
                    <label class="form-label">Payment Term :</label>
                    <input type="text" class="form-control" value={{update_manufacturing_unit.m_payment_term}} readonly>
                </div>
            </div>
    </div>

    <div class="row">
        <div class="col-6">
            <h4 class="my-3 fw-bold text-muted">Manufacturing Unit Address</h4>

            <div class="mb-3">
                <label class="form-label">Address :</label>
                <textarea class="form-control" cols="30" rows="4" readonly>{{update_manufacturing_unit_address.manufacturing_unit_address|capfirst}}, {{update_manufacturing_unit_address.manufacturing_unit_city}}, {{update_manufacturing_unit_address.manufacturing_unit_state|capfirst}} , {{update_manufacturing_unit_address.manufacturing_unit_country|capfirst}} - {{update_manufacturing_unit_address.manufacturing_unit_zip_code}}</textarea>
            </div>
        </div>
    </div>




    <div class="heading-button">
        {% comment %} <button type="button" class="btn-add" data-bs-toggle="modal"
        data-bs-target="#catalogmodal">+Add Catalog</button> {% endcomment %}

       


        <!-- Add single item modal -->
      
    <div class="container text-end">
        <button type="button" class="btn-add text-dark fw-bold" style=" background-color:#ed8b00;" data-bs-toggle="modal"
        data-bs-target="#openmodalmaster">+Add single items</button>
    </div>

        <div class="modal fade" id="openmodalmaster" >
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">

                    <!-- Modal Header -->

                    <div class="sub-heading shadow mb-4 rounded text-center encrypted_header">
                        Add Item
                    </div>
                    {{item}}
                    <!-- Modal body -->
                    <div class="modal-body">
                        <p style="color:red;" id="error_message"></p>
                        <form action="{% url 'add-product-to-unit' update_manufacturing_unit.id %}" id="Form" method="POST" class="add-new-item"  id="add-new-item">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-12">
                                    {% comment %} <div class="py-3">
                                        <label for="item" class="label-blue">Manufacturer</label>
                                        <input type="text" class="form-control add_single_field" name="manufacturer" id="manufacturer" required>
                                    </div> {% endcomment %}
                                   
                                    
                                    <div class="py-3">
                                        <label for="Iname" class="label-blue">Item name</label>
                                        <input type="text" id="item_name_mm" name="item_name" class="form-control add_single_field" required>
                                    </div>
                                    {% comment %} <div class="py-3">
                                        <label for="buy"
                                        class="label-blue">Buy/Sell/Both</label>
                                        <select class="form-select add_single_field" id="item_type" name="item_type" required>
                                            {% for type, value in item_types %}
                                            <option value="{{type}}">{{value}}</option>
                                            {% endfor %}
                                        </select>
                                    </div> {% endcomment %}
                                    <div class="py-3">
                                        <label for="itemCategory" class="label-blue">Item
                                            category</label>
                                            
                                            {% comment %} <select name="category" class="categoryName category form-control my-2" required>
                                                
                                            </select> {% endcomment %}
                                            <input type="text" name="category" id="category" class="form-control add_single_field" required>
                                        </div>
                                        <div class="py-3">
                                            <label for="Price" class="label-blue">Price</label>
                                            <input type="text" name="item_price" id="item_price" class="form-control add_single_field" required>
                                        </div>
                                        <div class="py-3">
                                            <label for="tax" class="label-blue">GST Percentage</label>
                                            <input type="text" name="tax" id="tax" class="form-control add_single_field" required>
                                        </div>
                                       
                                        
                                    </div>
                                
                            </div>
                            <div class="modal-footer">
                                <a href=""><button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button></a>
                                <input type="submit" value="Save"class="btn btn-success">
                                
                            </div>
                      
                    </form>
                            
                    </div>

                </div>
            </div>
        </div>
        <br>
    </div>


    <div class="invent_table">
        <div class="table-responsive">
           
            <table class="table table-bordered ">
                <thead style=" background-color:#ed8b00;"> 
                    {% comment %} table-heading-blue {% endcomment %}
                    <tr>
                        <th>Item id #</th>
                        <th>Item name</th>
                        <th>Item category</th>
                        {% comment %} <th style="width: 150px; min-width: 150px;">Current Stock</th> {% endcomment %}
                        {% comment %} <th style="width: 150px; min-width: 150px;">Unit</th> {% endcomment %}
                        <th style="width: 150px; min-width: 150px;">Price</th>
                        {% comment %} <th>Stock status</th> {% endcomment %}
                        {% comment %} <th>Product/Service</th> {% endcomment %}
                        {% comment %} <th>Type</th> {% endcomment %}
                        {% comment %} <th>HSN Code </th> {% endcomment %}
                        <th>GST Percentage</th>
                        {% comment %} <th>Warehouse </th> {% endcomment %}
                        <th style="width: 150px; min-width: 150px;" >Action</th>
                        {% comment %} <th style="width: 150px; min-width: 150px;" >Show Barcode</th> {% endcomment %}

                    </tr>
                </thead>
                <tr class="search">
                    <form method="GET" id="search-form">
                        {% comment %} <td><input type="text" class="search-item" name="search_by_id" placeholder="Search..."> </td>
                        <td><input type="text" class="search-item" name="search_by_name" placeholder="Search..."> </td>
                        <td><input type="text"class="search-item"  name="search_by_category" placeholder="Search..."> </td>
                     {% endcomment %}
                    
                    {% comment %} <td></td>
                    <td></td> {% endcomment %}
                    {% comment %} <td></td> {% endcomment %}
                    {% comment %} <td></td>
                    <td></td> {% endcomment %}
                    {% comment %} <td><input type="text" class="search-item" name="search_by_type" placeholder="Search..."> </td>
                    <td><input type="text" class="search-item" name="search_by_hsncode" placeholder="Search..."> </td> {% endcomment %}
                   {% comment %} <td></td> {% endcomment %}
                   
                </form>


                </tr>
                <tbody class="table-data-purple">
                    <tr>
                        {% for item in items %} 
                        <tr>
                            <td>P-{{item.id}}</td>
                            <td class="d-flex justify-content-between text-primary">{{ item.item_name }}
                            </td>
                            <td>{{ item.itemCategory}}</td>
                            {% comment %} <td class="text-end text-primary stock-td">{{item.stock}}</td>
                            <td>{{ item.unit_of_measurement }}</td> {% endcomment %}
                            <td><i class="fa fa-inr" aria-hidden="true"></i>
                                {{ item.price }}</td>
                            {% comment %} <td>Min limit missing</td> {% endcomment %}
                            {% comment %} <td>{{ item.product_or_service }}</td> {% endcomment %}
                            {% comment %} <td>{{ item.type }}</td> {% endcomment %}
                            {% comment %} <td>{{ item.hsn_code }}</td> {% endcomment %}
                            <td>{{ item.tax }}</td>
                            {% comment %} <td>{{ item.warehouse}}</td> {% endcomment %}
                            <td>
                               
                                    <a href="{% url 'edit-unit-product' item.id %}" class="btn fw-bold btn-sm"
                                    style="background-color:#ed8b00;">
                                        &#128393;
                                    </a>
                               
                                <i class="fa-solid fa-trash fa-fw item-delete text-danger" data-bs-toggle="modal"
                                data-bs-target="#openmodaldelete" data-delete-item-id="{{ item.id }}"></i>
                                <input type="hidden" class="delete-itemid" value="{{item.id}}">
                            </td>
                            {% comment %} <td> <button data-bs-toggle="modal" data-item-barcode="{{ item.barcode.url }}"data-bs-target="#openbarcode" class="open_barcode btn-add px-1" >Show Barcode</button></td>                             {% endcomment %}
                        </tr>
                        {% endfor %}
                    </tr>
                
                </tbody>
            </table>
            <!-- Modal to delete item  -->
            <div class="modal fade" id="openmodaldelete">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content">
                        <div class="modal-header bg-danger modal_header_del">
                            <h5 class="m-0">Delete Entry</h5>
                            <button type="button" class="modal_close_btn btn p-0" data-bs-dismiss="modal">&times;</button>
                        </div>
                        <div class="modal-body">
                            <form class="delete_item_form" method="post">
                                {% csrf_token %}
                                <div class="d-flex align-items-center mb-5 mt-3">
                                    <img src="{% static '/images/warning_icon.gif' %}" width="100px">
                                    <h4 class="ms-3">Are you sure you want to delete?</h4>
                                </div>
                                <button type="submit" class="btn btn-danger btn-md">Confirm delete</button>
                                <a href=""><button type="button" class="btn btn-default" data-bs-dismiss="modal">Cancel</button></a>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
<br><br>
    {% comment %} <div class="container text-end">
        <button class="btn btn-lg fw-bold" style="background-color:#ed8b00;">Save</button>
    </div> {% endcomment %}
</form>
<br><br><br>
</div>

<script>
    jQuery(document).ready(function(){
        jQuery(".item-delete").on("click",function(){
            var itemid = jQuery(this).attr("data-delete-item-id");
            jQuery(".delete_item_form").attr("action",`/delete-unit-product/${itemid}`)
        });
        
    });
</script>
{% endblock content %}
